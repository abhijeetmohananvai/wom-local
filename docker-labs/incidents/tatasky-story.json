{"inkVersion":19,"root":[["^Congratulations! Tata-sky is now one of our clients and you are the primary owner for this client, everything is going smooth. The DR audit is almost complete, you've requested the Tata sky team to whitelist these 3 URLs...","\n","ev","str","^---Send an email requesting to whitelist the URLs---","/str","/ev",{"*":"0.c-0","flg":4},{"c-0":[{"->":"wave0"},"\n",{"->":"0.g-0"},{"#f":5}],"g-0":["done",{"#f":5}]}],"done",{"wave0":[[["^tatasky-cca.vernacular.ai","\n",["^cca.vernacular.ai","\n",["^s3.ap-south-1.amazonaws.com","\n","^They return back saying they cannot whitelist the whole URLs, and have asked you to provide them static IPs instead ",{"->":"wave1"},"\n",{"#f":5,"#n":"g-2"}],{"#f":5,"#n":"g-1"}],{"#f":5,"#n":"g-0"}],null],{"#f":1}],"wave1":["^...","\n","^Since our existing EKS cluster is running with Classic Load balancer","\n","^We'll need a different way to this solution. ",{"->":"wave2"},"\n",{"#f":1}],"wave2":[["^What do you think we can do here?","\n","ev","str","^Create a new Network Load Balancers for the TS team","/str","/ev",{"*":".^.c-0","flg":20},"ev","str","^Map a New EIP for our existing NLB that we have","/str","/ev",{"*":".^.c-1","flg":20},{"c-0":["^ ",{"->":"wrong1"},"\n",{"#f":5}],"c-1":["^ ",{"->":"wrong2"},"\n",{"#f":5}]}],{"#f":1}],"wrong1":[["^Good thinking! But if we do this we won't be able to update the existing subnet configuration. And also aws doesn't allow to attach an elastic IP for an LB network interface. Understand the scenario first...","\n","ev","str","^Let's understand the issue thoroughly","/str","/ev",{"*":".^.c-0","flg":20},{"c-0":["^ ",{"->":"right1"},"\n",{"->":"wave2"},{"#f":5}]}],{"#f":1}],"wrong2":[["^This is a risky way since this can cause actual down time also doesn't guarantee the actual work flow, understand the scenario first...","\n","ev","str","^Let's understand the issue thoroughly","/str","/ev",{"*":".^.c-0","flg":20},{"c-0":["^ ",{"->":"right1"},"\n",{"->":"wave2"},{"#f":5}]}],{"#f":1}],"right1":["^It is said \"Half knowledge is worse than no knowledge\" so yes let's analyze again...","\n","^TataSky wants static IPs, so we need to provide our LB with static IPs. But our NLB and ALB doesn't have static IPs","\n","^DNS (cca.vernacular.ai) => NLB => FSM application via Kubernetes NodePort","\n",{"->":"wave3"},{"#f":1}],"wave3":[["^Now let's think of another solution to this?","\n","ev","str","^No, let's proceed with the first solution and react when we face a blocker","/str","/ev",{"*":".^.c-0","flg":20},"ev","str","^Yes, we can use Global accelerator","/str","/ev",{"*":".^.c-1","flg":20},{"c-0":["^ ",{"->":"wrong3"},"\n",{"#f":5}],"c-1":["^ ",{"->":"right2"},"\n",{"#f":5}]}],{"#f":1}],"wrong3":["^This is a wrong approach, we cannot just proceed knowing that we might get stuck in between, go back and try again ",{"->":"wave3"},"\n",{"#f":1}],"right2":["^Awsesome! We can actually proceed with this...","\n","^For this ALB,","\n","^1ea572a4-default-ingresspr-5033-197180353.ap-south-1.elb.amazonaws.com","\n","^We have two IPs => 75.2.10.200, 99.83.198.86","\n","^For this NLB,","\n","^a6466d743072e4cd6875c1fbf0e54356-77e655c73b3528de.elb.ap-south-1.amazonaws.com","\n","^We have two IPs => 13.248.177.234, 76.223.61.110 ",{"->":"wave4"},"\n",{"#f":1}],"wave4":[["ev","str","^Ask Tata Sky team to whitelist the URLs","/str","/ev",{"*":".^.c-0","flg":20},"ev","str","^Ask Tata Sky team to whitelist the 4 IPS and enable bi-directional traffic","/str","/ev",{"*":".^.c-1","flg":20},{"c-0":["^ ",{"->":"wrong4"},"\n",{"#f":5}],"c-1":["^ ",{"->":"right3"},"\n",{"#f":5}]}],{"#f":1}],"wrong4":["^No, we can't do that, they've already asked to share IPs instead of DNS. Please try again ",{"->":"wave4"},"\n",{"#f":1}],"right3":[["^Exactly, we have to whitelist the IPs... proceeding URLs will just be a loop to this problem.","\n",["ev",{"^->":"right3.0.2.$r1"},{"temp=":"$r"},"str",{"->":".^.s"},[{"#n":"$r1"}],"/str","/ev",{"*":".^.^.c-0","flg":2},{"s":["^---The IPs have now been whitelisted--- ",{"->":"$r","var":true},null]}],{"c-0":["ev",{"^->":"right3.0.c-0.$r2"},"/ev",{"temp=":"$r"},{"->":".^.^.2.s"},[{"#n":"$r2"}],"\n",{"->":"wave5"},{"#f":5}]}],{"#f":1}],"wave5":[["^Next, how will the server understand which IP is pointing at what?","\n","^You: We can resolve a hostname to the IP","\n","^Great thinking! Go ahead and do it...","\n",["ev",{"^->":"wave5.0.6.$r1"},{"temp=":"$r"},"str",{"->":".^.s"},[{"#n":"$r1"}],"/str","/ev",{"*":".^.^.c-0","flg":2},{"s":["^vi /etc/hosts",{"->":"$r","var":true},null]}],{"c-0":["ev",{"^->":"wave5.0.c-0.$r2"},"/ev",{"temp=":"$r"},{"->":".^.^.6.s"},[{"#n":"$r2"}],"\n","^75.2.10.200 tatasky-cca.vernacular.ai","\n","^99.83.198.86 tatasky-cca.vernacular.ai","\n","^13.248.177.234 cca.vernacular.ai","\n","^76.223.61.110 cca.vernacular.ai","\n","^:wq!","\n","^Perfect!","\n",{"->":"wave6"},{"#f":5}]}],{"#f":1}],"wave6":[["^Great job! Now you just need to deploy Router and MRCP","\n","^You can use the outline document to get a better understanding of the deployment process..","\n","^Remember to configure Router & MRCP with DNS not IPs","\n","ev","str","^Deploy Router","/str","/ev",{"*":".^.c-0","flg":20},{"c-0":["^ ",{"->":"wrong5"},"\n",{"#f":5}]}],{"#f":1}],"wrong5":[["^Instead of deploying the router and configuring the FSM_HOST, let's redeploy Router and pass an environment variable FSM_HOST=tatasky-cca.vernacular.ai443","\n","ev","str","^Redeploy the router with following changes","/str","/ev",{"*":".^.c-0","flg":20},{"c-0":["\n","^Awesome!","\n",{"->":"wave7"},{"#f":5}]}],{"#f":1}],"wave7":[[["ev",{"^->":"wave7.0.0.$r1"},{"temp=":"$r"},"str",{"->":".^.s"},[{"#n":"$r1"}],"/str","/ev",{"*":".^.^.c-0","flg":2},{"s":["^---Deployed MRCP---",{"->":"$r","var":true},null]}],{"c-0":["ev",{"^->":"wave7.0.c-0.$r2"},"/ev",{"temp=":"$r"},{"->":".^.^.0.s"},[{"#n":"$r2"}],"\n","^Nice!","\n",{"->":"wave8"},{"#f":5}]}],{"#f":1}],"wave8":[[["ev",{"^->":"wave8.0.0.$r1"},{"temp=":"$r"},"str",{"->":".^.s"},[{"#n":"$r1"}],"/str","/ev",{"*":".^.^.c-0","flg":2},{"s":["^Now let's configure MRCP with DNS not IPs",{"->":"$r","var":true},null]}],{"c-0":["ev",{"^->":"wave8.0.c-0.$r2"},"/ev",{"temp=":"$r"},{"->":".^.^.0.s"},[{"#n":"$r2"}],"\n","^For MRCP,","\n","^CCA_HOST= cca.vernacular.ai:443","\n",{"->":"wave9"},{"#f":5}]}],{"#f":1}],"wave9":[["^Go on and test the application, the whitelisted IPs and resolved hostnames so we can be sure the issue is resolved.","\n","ev","str","^---Test the application---","/str","/ev",{"*":".^.c-0","flg":4},{"c-0":["^ ",{"->":"wave10"},"\n",{"#f":5}]}],{"#f":1}],"wave10":["^Awesome job! You've solved one more issue... ","end","\n",{"#f":1}],"#f":1}],"listDefs":{}}
